Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

Install the latest PowerShell for new features and improvements! https://aka.ms/PSWindows

PS F:\dataset> wsl
Welcome to Ubuntu 22.04.5 LTS (GNU/Linux 6.6.87.2-microsoft-standard-WSL2 x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Tue Sep  9 12:30:31 CEST 2025

  System load:  0.0                 Processes:             59
  Usage of /:   1.9% of 1006.85GB   Users logged in:       0
  Memory usage: 5%                  IPv4 address for eth0: 172.24.180.229
  Swap usage:   0%

 * Strictly confined Kubernetes makes edge and IoT secure. Learn how MicroK8s
   just raised the bar for easy, resilient and secure K8s cluster deployment.

   https://ubuntu.com/engage/secure-kubernetes-at-the-edge

This message is shown once a day. To disable it please create the
/home/pingvin/.hushlogin file.
pingvin@DESKTOP-84F9M51:/mnt/f/dataset$ code Automatised-Analysis-of-Darknet-Sources/
pingvin@DESKTOP-84F9M51:/mnt/f/dataset$ source mamba-env/bin/activate
(mamba-env) pingvin@DESKTOP-84F9M51:/mnt/f/dataset$ python3 Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py
^CTraceback (most recent call last):
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 7, in <module>
    from transformers import AutoTokenizer
  File "<frozen importlib._bootstrap>", line 1075, in _handle_fromlist
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 2292, in __getattr__
    module = self._get_module(self._class_to_module[name])
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 2320, in _get_module
    return importlib.import_module("." + module_name, self.__name__)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/transformers/models/auto/tokenization_auto.py", line 40, in <module>
    from .auto_factory import _LazyAutoMapping
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/transformers/models/auto/auto_factory.py", line 43, in <module>
    from ...generation import GenerationMixin
  File "<frozen importlib._bootstrap>", line 1075, in _handle_fromlist
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 2292, in __getattr__
    module = self._get_module(self._class_to_module[name])
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 2320, in _get_module
    return importlib.import_module("." + module_name, self.__name__)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/transformers/generation/utils.py", line 62, in <module>
    from .candidate_generator import (
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/transformers/generation/candidate_generator.py", line 29, in <module>
    from sklearn.metrics import roc_curve
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/__init__.py", line 73, in <module>
    from .base import clone  # noqa: E402
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/base.py", line 19, in <module>
    from .utils._metadata_requests import _MetadataRequester, _routing_enabled
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/utils/__init__.py", line 9, in <module>
    from ._chunking import gen_batches, gen_even_slices
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/utils/_chunking.py", line 11, in <module>
    from ._param_validation import Interval, validate_params
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 17, in <module>
    from .validation import _is_arraylike_not_scalar
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/utils/validation.py", line 21, in <module>
    from ..utils._array_api import _asarray_with_order, _is_numpy_namespace, get_namespace
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/utils/_array_api.py", line 20, in <module>
    from .fixes import parse_version
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/utils/fixes.py", line 20, in <module>
    import pandas as pd
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/pandas/__init__.py", line 49, in <module>
    from pandas.core.api import (
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/pandas/core/api.py", line 47, in <module>
    from pandas.core.groupby import (
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/pandas/core/groupby/__init__.py", line 1, in <module>
    from pandas.core.groupby.generic import (
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/pandas/core/groupby/generic.py", line 68, in <module>
    from pandas.core.frame import DataFrame
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 879, in exec_module
  File "<frozen importlib._bootstrap_external>", line 975, in get_code
  File "<frozen importlib._bootstrap_external>", line 1074, in get_data
KeyboardInterrupt

(mamba-env) pingvin@DESKTOP-84F9M51:/mnt/f/dataset$ source mamba-env/bin/activate
(mamba-env) pingvin@DESKTOP-84F9M51:/mnt/f/dataset$ python3 Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py
Traceback (most recent call last):
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 17, in <module>
    from utils import save_plots, save_confusion_matrix # New: Import plotting utilities
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/utils.py", line 3, in <module>
    import seaborn as sns
ModuleNotFoundError: No module named 'seaborn'
(mamba-env) pingvin@DESKTOP-84F9M51:/mnt/f/dataset$ pip install seaborn
Collecting seaborn
  Downloading seaborn-0.13.2-py3-none-any.whl.metadata (5.4 kB)
Requirement already satisfied: numpy!=1.24.0,>=1.20 in ./mamba-env/lib/python3.10/site-packages (from seaborn) (2.1.2)
Requirement already satisfied: pandas>=1.2 in ./mamba-env/lib/python3.10/site-packages (from seaborn) (2.3.2)
Requirement already satisfied: matplotlib!=3.6.1,>=3.4 in ./mamba-env/lib/python3.10/site-packages (from seaborn) (3.10.5)
Requirement already satisfied: contourpy>=1.0.1 in ./mamba-env/lib/python3.10/site-packages (from matplotlib!=3.6.1,>=3.4->seaborn) (1.3.2)
Requirement already satisfied: cycler>=0.10 in ./mamba-env/lib/python3.10/site-packages (from matplotlib!=3.6.1,>=3.4->seaborn) (0.12.1)
Requirement already satisfied: fonttools>=4.22.0 in ./mamba-env/lib/python3.10/site-packages (from matplotlib!=3.6.1,>=3.4->seaborn) (4.59.1)
Requirement already satisfied: kiwisolver>=1.3.1 in ./mamba-env/lib/python3.10/site-packages (from matplotlib!=3.6.1,>=3.4->seaborn) (1.4.9)
Requirement already satisfied: packaging>=20.0 in ./mamba-env/lib/python3.10/site-packages (from matplotlib!=3.6.1,>=3.4->seaborn) (25.0)
Requirement already satisfied: pillow>=8 in ./mamba-env/lib/python3.10/site-packages (from matplotlib!=3.6.1,>=3.4->seaborn) (11.0.0)
Requirement already satisfied: pyparsing>=2.3.1 in ./mamba-env/lib/python3.10/site-packages (from matplotlib!=3.6.1,>=3.4->seaborn) (3.2.3)
Requirement already satisfied: python-dateutil>=2.7 in ./mamba-env/lib/python3.10/site-packages (from matplotlib!=3.6.1,>=3.4->seaborn) (2.9.0.post0)
Requirement already satisfied: pytz>=2020.1 in ./mamba-env/lib/python3.10/site-packages (from pandas>=1.2->seaborn) (2025.2)
Requirement already satisfied: tzdata>=2022.7 in ./mamba-env/lib/python3.10/site-packages (from pandas>=1.2->seaborn) (2025.2)
Requirement already satisfied: six>=1.5 in ./mamba-env/lib/python3.10/site-packages (from python-dateutil>=2.7->matplotlib!=3.6.1,>=3.4->seaborn) (1.17.0)
Downloading seaborn-0.13.2-py3-none-any.whl (294 kB)
Installing collected packages: seaborn
Successfully installed seaborn-0.13.2
(mamba-env) pingvin@DESKTOP-84F9M51:/mnt/f/dataset$ python3 Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py
Using device: cuda
Loading data from reviewed_pseudolabels.csv...
Total samples: 4126
Train samples: 3300
Validation samples: 826
Model: MambaClassifier(
  (embedding): Embedding(30522, 768)
  (mamba_layers): ModuleList(
    (0-15): 16 x Mamba(
      (in_proj): Linear(in_features=768, out_features=3072, bias=False)
      (conv1d): Conv1d(1536, 1536, kernel_size=(4,), stride=(1,), padding=(3,), groups=1536)
      (act): SiLU()
      (x_proj): Linear(in_features=1536, out_features=80, bias=False)
      (dt_proj): Linear(in_features=48, out_features=1536, bias=True)
      (out_proj): Linear(in_features=1536, out_features=768, bias=False)
    )
  )
  (global_pool): AdaptiveAvgPool1d(output_size=1)
  (classifier): Sequential(
    (0): Linear(in_features=768, out_features=384, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=384, out_features=4, bias=True)
  )
)
Number of parameters: 84071812
Traceback (most recent call last):
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 200, in <module>
    main("reviewed_pseudolabels.csv")
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 167, in main
    train_loss = train_epoch(model, train_loader, optimizer, criterion, device, epoch)
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 88, in train_epoch
    for batch_idx, (input_ids, labels) in enumerate(progress_bar):
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 734, in __next__
    data = self._next_data()
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1516, in _next_data
    return self._process_data(data, worker_id)
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1551, in _process_data
    data.reraise()
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/torch/_utils.py", line 769, in reraise
    raise exception
FileNotFoundError: Caught FileNotFoundError in DataLoader worker process 2.
Original Traceback (most recent call last):
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 349, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/data_loader.py", line 43, in __getitem__
    text = clean_html(path)
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/data_loader.py", line 13, in clean_html
    with open(file_path, encoding="utf-8", errors="ignore") as f:
FileNotFoundError: [Errno 2] No such file or directory: 'undefined'

(mamba-env) pingvin@DESKTOP-84F9M51:/mnt/f/dataset$ python3 Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py
Using device: cuda
Loading data from reviewed_pseudolabels.csv...
Total samples: 4126
Train samples: 3300
Validation samples: 826
Model: MambaClassifier(
  (embedding): Embedding(30522, 768)
  (mamba_layers): ModuleList(
    (0-15): 16 x Mamba(
      (in_proj): Linear(in_features=768, out_features=3072, bias=False)
      (conv1d): Conv1d(1536, 1536, kernel_size=(4,), stride=(1,), padding=(3,), groups=1536)
      (act): SiLU()
      (x_proj): Linear(in_features=1536, out_features=80, bias=False)
      (dt_proj): Linear(in_features=48, out_features=1536, bias=True)
      (out_proj): Linear(in_features=1536, out_features=768, bias=False)
    )
  )
  (global_pool): AdaptiveAvgPool1d(output_size=1)
  (classifier): Sequential(
    (0): Linear(in_features=768, out_features=384, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=384, out_features=4, bias=True)
  )
)
Number of parameters: 84071812
Traceback (most recent call last):
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 200, in <module>
    main("reviewed_pseudolabels.csv")
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 167, in main
    train_loss = train_epoch(model, train_loader, optimizer, criterion, device, epoch)
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 88, in train_epoch
    for batch_idx, (input_ids, labels) in enumerate(progress_bar):
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 734, in __next__
    data = self._next_data()
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1516, in _next_data
    return self._process_data(data, worker_id)
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1551, in _process_data
    data.reraise()
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/torch/_utils.py", line 769, in reraise
    raise exception
OSError: Caught OSError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 349, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/data_loader.py", line 43, in __getitem__
    text = clean_html(path)
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/data_loader.py", line 13, in clean_html
    with open(file_path, encoding="utf-8", errors="ignore") as f:
OSError: [Errno 22] Invalid argument: 'engpass/162625_25900625_49433432.html'

(mamba-env) pingvin@DESKTOP-84F9M51:/mnt/f/dataset$ python3 Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py
Using device: cuda
Loading data from reviewed_pseudolabels.csv...
Total samples: 4126
Train samples: 3300
Validation samples: 826
Model: MambaClassifier(
  (embedding): Embedding(30522, 768)
  (mamba_layers): ModuleList(
    (0-15): 16 x Mamba(
      (in_proj): Linear(in_features=768, out_features=3072, bias=False)
      (conv1d): Conv1d(1536, 1536, kernel_size=(4,), stride=(1,), padding=(3,), groups=1536)
      (act): SiLU()
      (x_proj): Linear(in_features=1536, out_features=80, bias=False)
      (dt_proj): Linear(in_features=48, out_features=1536, bias=True)
      (out_proj): Linear(in_features=1536, out_features=768, bias=False)
    )
  )
  (global_pool): AdaptiveAvgPool1d(output_size=1)
  (classifier): Sequential(
    (0): Linear(in_features=768, out_features=384, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=384, out_features=4, bias=True)
  )
)
Number of parameters: 84071812
Traceback (most recent call last):
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 200, in <module>
    main("reviewed_pseudolabels.csv")
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 167, in main
    train_loss = train_epoch(model, train_loader, optimizer, criterion, device, epoch)
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 88, in train_epoch
    for batch_idx, (input_ids, labels) in enumerate(progress_bar):
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 734, in __next__
    data = self._next_data()
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1516, in _next_data
    return self._process_data(data, worker_id)
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1551, in _process_data
    data.reraise()
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/torch/_utils.py", line 769, in reraise
    raise exception
FileNotFoundError: Caught FileNotFoundError in DataLoader worker process 2.
Original Traceback (most recent call last):
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 349, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/data_loader.py", line 43, in __getitem__
    text = clean_html(path)
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/data_loader.py", line 13, in clean_html
    with open(file_path, encoding="utf-8", errors="ignore") as f:
FileNotFoundError: [Errno 2] No such file or directory: 'engpass/162625_25900625_49433432.html'

(mamba-env) pingvin@DESKTOP-84F9M51:/mnt/f/dataset$ python3 Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py
Using device: cuda
Loading data from reviewed_pseudolabels.csv...
Traceback (most recent call last):
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 203, in <module>
    main("reviewed_pseudolabels.csv")
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 145, in main
    train_loader, val_loader, _, _ = prepare_data_from_csv(csv_file)
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 48, in prepare_data_from_csv
    if not os.path.exists(file_path):
NameError: name 'file_path' is not defined. Did you mean: 'csv_file_path'?
(mamba-env) pingvin@DESKTOP-84F9M51:/mnt/f/dataset$ python3 Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py
Using device: cuda
Loading data from reviewed_pseudolabels.csv...
Traceback (most recent call last):
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 206, in <module>
    main("reviewed_pseudolabels.csv")
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 148, in main
    train_loader, val_loader, _, _ = prepare_data_from_csv(csv_file)
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 67, in prepare_data_from_csv
    raise ValueError(f"The file '{file_path}' does not exist.")
ValueError: The file 'engpass/162625_25900625_49433432.html' does not exist.
(mamba-env) pingvin@DESKTOP-84F9M51:/mnt/f/dataset$ python3 Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py
Using device: cuda
Loading data from reviewed_pseudolabels.csv...
Total samples: 4124
Train samples: 3299
Validation samples: 825
Model: MambaClassifier(
  (embedding): Embedding(30522, 768)
  (mamba_layers): ModuleList(
    (0-15): 16 x Mamba(
      (in_proj): Linear(in_features=768, out_features=3072, bias=False)
      (conv1d): Conv1d(1536, 1536, kernel_size=(4,), stride=(1,), padding=(3,), groups=1536)
      (act): SiLU()
      (x_proj): Linear(in_features=1536, out_features=80, bias=False)
      (dt_proj): Linear(in_features=48, out_features=1536, bias=True)
      (out_proj): Linear(in_features=1536, out_features=768, bias=False)
    )
  )
  (global_pool): AdaptiveAvgPool1d(output_size=1)
  (classifier): Sequential(
    (0): Linear(in_features=768, out_features=384, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=384, out_features=4, bias=True)
  )
)
Number of parameters: 84071812
Epoch 1/10:
  Train Loss: 1.3377
  Val Loss: 1.2749, Accuracy: 0.9515, Precision: 0.9054, Recall: 0.9515, F1-score: 0.9279
  Saved new best model with F1-score: 0.9279
Epoch 2/10:
  Train Loss: 1.1976
  Val Loss: 1.1078, Accuracy: 0.9515, Precision: 0.9054, Recall: 0.9515, F1-score: 0.9279
Epoch 3/10:
  Train Loss: 1.0053
  Val Loss: 0.8935, Accuracy: 0.9515, Precision: 0.9054, Recall: 0.9515, F1-score: 0.9279
Epoch 4/10:
  Train Loss: 0.7841
  Val Loss: 0.6757, Accuracy: 0.9515, Precision: 0.9054, Recall: 0.9515, F1-score: 0.9279
Epoch 5/10:
  Train Loss: 0.5864
  Val Loss: 0.5021, Accuracy: 0.9515, Precision: 0.9054, Recall: 0.9515, F1-score: 0.9279
Epoch 6/10:
  Train Loss: 0.4433
  Val Loss: 0.3892, Accuracy: 0.9515, Precision: 0.9054, Recall: 0.9515, F1-score: 0.9279
Epoch 7/10:
  Train Loss: 0.3572
  Val Loss: 0.3239, Accuracy: 0.9515, Precision: 0.9054, Recall: 0.9515, F1-score: 0.9279
Epoch 8/10:
  Train Loss: 0.3058
  Val Loss: 0.2873, Accuracy: 0.9515, Precision: 0.9054, Recall: 0.9515, F1-score: 0.9279
Epoch 9/10:
  Train Loss: 0.2780
  Val Loss: 0.2666, Accuracy: 0.9515, Precision: 0.9054, Recall: 0.9515, F1-score: 0.9279
Epoch 10/10:
  Train Loss: 0.2614
  Val Loss: 0.2545, Accuracy: 0.9515, Precision: 0.9054, Recall: 0.9515, F1-score: 0.9279

Training finished!
Best Validation F1-score: 0.9279
Saving plots to results...
Plots saved successfully.
(mamba-env) pingvin@DESKTOP-84F9M51:/mnt/f/dataset$ python3 Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py
Using device: cuda
Loading data from reviewed_pseudolabels.csv...
Total samples: 4124
Train samples: 3299
Validation samples: 825
Model: MambaClassifier(
  (embedding): Embedding(30522, 768)
  (mamba_layers): ModuleList(
    (0-15): 16 x Mamba(
      (in_proj): Linear(in_features=768, out_features=3072, bias=False)
      (conv1d): Conv1d(1536, 1536, kernel_size=(4,), stride=(1,), padding=(3,), groups=1536)
      (act): SiLU()
      (x_proj): Linear(in_features=1536, out_features=80, bias=False)
      (dt_proj): Linear(in_features=48, out_features=1536, bias=True)
      (out_proj): Linear(in_features=1536, out_features=768, bias=False)
    )
  )
  (global_pool): AdaptiveAvgPool1d(output_size=1)
  (classifier): Sequential(
    (0): Linear(in_features=768, out_features=384, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=384, out_features=4, bias=True)
  )
)
Number of parameters: 84071812
/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py:171: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  weights = torch.tensor(weights, dtype=torch.float).to(device)
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.9515    1.0000    0.9752       785
           1     0.0000    0.0000    0.0000         6
           2     0.0000    0.0000    0.0000         4
           3     0.0000    0.0000    0.0000        30

    accuracy                         0.9515       825
   macro avg     0.2379    0.2500    0.2438       825
weighted avg     0.9054    0.9515    0.9279       825

Epoch 1/5:
  Train Loss: 1.3379
  Val Loss: 1.2883, Accuracy: 0.9515, Precision: 0.2379, Recall: 0.2500, F1-score: 0.2438
  Saved new best model with F1-score: 0.2438
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.9515    1.0000    0.9752       785
           1     0.0000    0.0000    0.0000         6
           2     0.0000    0.0000    0.0000         4
           3     0.0000    0.0000    0.0000        30

    accuracy                         0.9515       825
   macro avg     0.2379    0.2500    0.2438       825
weighted avg     0.9054    0.9515    0.9279       825

Epoch 2/5:
  Train Loss: 1.2318
  Val Loss: 1.1646, Accuracy: 0.9515, Precision: 0.2379, Recall: 0.2500, F1-score: 0.2438
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.9515    1.0000    0.9752       785
           1     0.0000    0.0000    0.0000         6
           2     0.0000    0.0000    0.0000         4
           3     0.0000    0.0000    0.0000        30

    accuracy                         0.9515       825
   macro avg     0.2379    0.2500    0.2438       825
weighted avg     0.9054    0.9515    0.9279       825

Epoch 3/5:
  Train Loss: 1.0886
  Val Loss: 1.0079, Accuracy: 0.9515, Precision: 0.2379, Recall: 0.2500, F1-score: 0.2438
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.9515    1.0000    0.9752       785
           1     0.0000    0.0000    0.0000         6
           2     0.0000    0.0000    0.0000         4
           3     0.0000    0.0000    0.0000        30

    accuracy                         0.9515       825
   macro avg     0.2379    0.2500    0.2438       825
weighted avg     0.9054    0.9515    0.9279       825

Epoch 4/5:
  Train Loss: 0.9272
  Val Loss: 0.8498, Accuracy: 0.9515, Precision: 0.2379, Recall: 0.2500, F1-score: 0.2438
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.9515    1.0000    0.9752       785
           1     0.0000    0.0000    0.0000         6
           2     0.0000    0.0000    0.0000         4
           3     0.0000    0.0000    0.0000        30

    accuracy                         0.9515       825
   macro avg     0.2379    0.2500    0.2438       825
weighted avg     0.9054    0.9515    0.9279       825

Epoch 5/5:
  Train Loss: 0.7763
  Val Loss: 0.7292, Accuracy: 0.9515, Precision: 0.2379, Recall: 0.2500, F1-score: 0.2438

Training finished!
Best Validation F1-score: 0.2438
Saving plots to results...
Plots saved successfully.
(mamba-env) pingvin@DESKTOP-84F9M51:/mnt/f/dataset$ python3 Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py
Using device: cuda
Loading data from final.csv...
Total samples: 4265
Train samples: 3412
Validation samples: 853
Model: MambaClassifier(
  (embedding): Embedding(30522, 768)
  (mamba_layers): ModuleList(
    (0-15): 16 x Mamba(
      (in_proj): Linear(in_features=768, out_features=3072, bias=False)
      (conv1d): Conv1d(1536, 1536, kernel_size=(4,), stride=(1,), padding=(3,), groups=1536)
      (act): SiLU()
      (x_proj): Linear(in_features=1536, out_features=80, bias=False)
      (dt_proj): Linear(in_features=48, out_features=1536, bias=True)
      (out_proj): Linear(in_features=1536, out_features=768, bias=False)
    )
  )
  (global_pool): AdaptiveAvgPool1d(output_size=1)
  (classifier): Sequential(
    (0): Linear(in_features=768, out_features=384, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=384, out_features=4, bias=True)
  )
)
Number of parameters: 84071812
/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py:171: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  weights = torch.tensor(weights, dtype=torch.float).to(device)
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.0000    0.0000    0.0000       200
           1     0.0000    0.0000    0.0000         6
           2     0.0000    0.0000    0.0000        17
           3     0.7386    1.0000    0.8496       630

    accuracy                         0.7386       853
   macro avg     0.1846    0.2500    0.2124       853
weighted avg     0.5455    0.7386    0.6275       853

Epoch 1/5:
  Train Loss: 1.3803
  Val Loss: 1.3512, Accuracy: 0.7386, Precision: 0.1846, Recall: 0.2500, F1-score: 0.2124
  Saved new best model with F1-score: 0.2124
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.0000    0.0000    0.0000       200
           1     0.0000    0.0000    0.0000         6
           2     0.0000    0.0000    0.0000        17
           3     0.7386    1.0000    0.8496       630

    accuracy                         0.7386       853
   macro avg     0.1846    0.2500    0.2124       853
weighted avg     0.5455    0.7386    0.6275       853

Epoch 2/5:
  Train Loss: 1.3155
  Val Loss: 1.2758, Accuracy: 0.7386, Precision: 0.1846, Recall: 0.2500, F1-score: 0.2124
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.0000    0.0000    0.0000       200
           1     0.0000    0.0000    0.0000         6
           2     0.0000    0.0000    0.0000        17
           3     0.7386    1.0000    0.8496       630

    accuracy                         0.7386       853
   macro avg     0.1846    0.2500    0.2124       853
weighted avg     0.5455    0.7386    0.6275       853

Epoch 3/5:
  Train Loss: 1.2298
  Val Loss: 1.1831, Accuracy: 0.7386, Precision: 0.1846, Recall: 0.2500, F1-score: 0.2124
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.0000    0.0000    0.0000       200
           1     0.0000    0.0000    0.0000         6
           2     0.0000    0.0000    0.0000        17
           3     0.7386    1.0000    0.8496       630

    accuracy                         0.7386       853
   macro avg     0.1846    0.2500    0.2124       853
weighted avg     0.5455    0.7386    0.6275       853

Epoch 4/5:
  Train Loss: 1.1347
  Val Loss: 1.0903, Accuracy: 0.7386, Precision: 0.1846, Recall: 0.2500, F1-score: 0.2124
Epoch 5 Training:   2%|█                                                   | 9/427 [00:07<05:26,  1.28it/s, loss=1.1222]Traceback (most recent call last):
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 216, in <module>
    main('final.csv')
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 183, in main
    train_loss = train_epoch(model, train_loader, optimizer, criterion, device, epoch)
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 115, in train_epoch
    total_loss += loss.item() * GRADIENT_ACCUMULATION_STEPS
KeyboardInterrupt

(mamba-env) pingvin@DESKTOP-84F9M51:/mnt/f/dataset$ python3 Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py
Using device: cuda
Loading data from final.csv...
Total samples: 4265
Train samples: 3412
Validation samples: 853
Model: MambaClassifier(
  (embedding): Embedding(30522, 768)
  (mamba_layers): ModuleList(
    (0-15): 16 x Mamba(
      (in_proj): Linear(in_features=768, out_features=3072, bias=False)
      (conv1d): Conv1d(1536, 1536, kernel_size=(4,), stride=(1,), padding=(3,), groups=1536)
      (act): SiLU()
      (x_proj): Linear(in_features=1536, out_features=80, bias=False)
      (dt_proj): Linear(in_features=48, out_features=1536, bias=True)
      (out_proj): Linear(in_features=1536, out_features=768, bias=False)
    )
  )
  (global_pool): AdaptiveAvgPool1d(output_size=1)
  (classifier): Sequential(
    (0): Linear(in_features=768, out_features=384, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=384, out_features=4, bias=True)
  )
)
Number of parameters: 84071812
/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py:171: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  weights = torch.tensor(weights, dtype=torch.float).to(device)
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.0000    0.0000    0.0000       200
           1     0.0000    0.0000    0.0000         6
           2     0.0000    0.0000    0.0000        17
           3     0.7386    1.0000    0.8496       630

    accuracy                         0.7386       853
   macro avg     0.1846    0.2500    0.2124       853
weighted avg     0.5455    0.7386    0.6275       853

Epoch 1/5:
  Train Loss: 1.3414
  Val Loss: 1.3019, Accuracy: 0.7386, Precision: 0.1846, Recall: 0.2500, F1-score: 0.2124
  Saved new best model with F1-score: 0.2124
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.0000    0.0000    0.0000       200
           1     0.0000    0.0000    0.0000         6
           2     0.0000    0.0000    0.0000        17
           3     0.7386    1.0000    0.8496       630

    accuracy                         0.7386       853
   macro avg     0.1846    0.2500    0.2124       853
weighted avg     0.5455    0.7386    0.6275       853

Epoch 2/5:
  Train Loss: 1.2550
  Val Loss: 1.2008, Accuracy: 0.7386, Precision: 0.1846, Recall: 0.2500, F1-score: 0.2124
Epoch 3 Training:   8%|████                                               | 34/427 [00:26<05:03,  1.29it/s, loss=1.1945]Traceback (most recent call last):
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 216, in <module>
    main('final.csv')
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 183, in main
    train_loss = train_epoch(model, train_loader, optimizer, criterion, device, epoch)
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 115, in train_epoch
    total_loss += loss.item() * GRADIENT_ACCUMULATION_STEPS
KeyboardInterrupt

(mamba-env) pingvin@DESKTOP-84F9M51:/mnt/f/dataset$ python3 Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py
Using device: cuda
Loading data from final.csv...
Total samples: 4265
Train samples: 2559
Validation samples: 1706
Model: MambaClassifier(
  (embedding): Embedding(30522, 768)
  (mamba_layers): ModuleList(
    (0-15): 16 x Mamba(
      (in_proj): Linear(in_features=768, out_features=3072, bias=False)
      (conv1d): Conv1d(1536, 1536, kernel_size=(4,), stride=(1,), padding=(3,), groups=1536)
      (act): SiLU()
      (x_proj): Linear(in_features=1536, out_features=80, bias=False)
      (dt_proj): Linear(in_features=48, out_features=1536, bias=True)
      (out_proj): Linear(in_features=1536, out_features=768, bias=False)
    )
  )
  (global_pool): AdaptiveAvgPool1d(output_size=1)
  (classifier): Sequential(
    (0): Linear(in_features=768, out_features=384, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=384, out_features=4, bias=True)
  )
)
Number of parameters: 84071812
/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py:171: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  weights = torch.tensor(weights, dtype=torch.float).to(device)
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.0000    0.0000    0.0000       400
           1     0.0000    0.0000    0.0000        11
           2     0.0000    0.0000    0.0000        35
           3     0.7386    1.0000    0.8496      1260

    accuracy                         0.7386      1706
   macro avg     0.1846    0.2500    0.2124      1706
weighted avg     0.5455    0.7386    0.6275      1706

Epoch 1/5:
  Train Loss: 1.3699
  Val Loss: 1.3404, Accuracy: 0.7386, Precision: 0.1846, Recall: 0.2500, F1-score: 0.2124
  Saved new best model with F1-score: 0.2124
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.0000    0.0000    0.0000       400
           1     0.0000    0.0000    0.0000        11
           2     0.0000    0.0000    0.0000        35
           3     0.7386    1.0000    0.8496      1260

    accuracy                         0.7386      1706
   macro avg     0.1846    0.2500    0.2124      1706
weighted avg     0.5455    0.7386    0.6275      1706

Epoch 2/5:
  Train Loss: 1.3067
  Val Loss: 1.2688, Accuracy: 0.7386, Precision: 0.1846, Recall: 0.2500, F1-score: 0.2124
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.0000    0.0000    0.0000       400
           1     0.0000    0.0000    0.0000        11
           2     0.0000    0.0000    0.0000        35
           3     0.7386    1.0000    0.8496      1260

    accuracy                         0.7386      1706
   macro avg     0.1846    0.2500    0.2124      1706
weighted avg     0.5455    0.7386    0.6275      1706

Epoch 3/5:
  Train Loss: 1.2255
  Val Loss: 1.1770, Accuracy: 0.7386, Precision: 0.1846, Recall: 0.2500, F1-score: 0.2124
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.0000    0.0000    0.0000       400
           1     0.0000    0.0000    0.0000        11
           2     0.0000    0.0000    0.0000        35
           3     0.7386    1.0000    0.8496      1260

    accuracy                         0.7386      1706
   macro avg     0.1846    0.2500    0.2124      1706
weighted avg     0.5455    0.7386    0.6275      1706

Epoch 4/5:
  Train Loss: 1.1259
  Val Loss: 1.0724, Accuracy: 0.7386, Precision: 0.1846, Recall: 0.2500, F1-score: 0.2124
Epoch 5 Training:  24%|████████████▍                                      | 78/320 [01:00<02:38,  1.53it/s, loss=1.0638]Traceback (most recent call last):
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 216, in <module>
    main('final.csv')
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 183, in main
    train_loss = train_epoch(model, train_loader, optimizer, criterion, device, epoch)
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 115, in train_epoch
    total_loss += loss.item() * GRADIENT_ACCUMULATION_STEPS
KeyboardInterrupt

(mamba-env) pingvin@DESKTOP-84F9M51:/mnt/f/dataset$ python3 Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py
Using device: cuda
Loading data from final.csv...
Total samples: 10636
Train samples: 6381
Validation samples: 4255
Model: MambaClassifier(
  (embedding): Embedding(30522, 768)
  (mamba_layers): ModuleList(
    (0-15): 16 x Mamba(
      (in_proj): Linear(in_features=768, out_features=3072, bias=False)
      (conv1d): Conv1d(1536, 1536, kernel_size=(4,), stride=(1,), padding=(3,), groups=1536)
      (act): SiLU()
      (x_proj): Linear(in_features=1536, out_features=80, bias=False)
      (dt_proj): Linear(in_features=48, out_features=1536, bias=True)
      (out_proj): Linear(in_features=1536, out_features=768, bias=False)
    )
  )
  (global_pool): AdaptiveAvgPool1d(output_size=1)
  (classifier): Sequential(
    (0): Linear(in_features=768, out_features=384, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=384, out_features=4, bias=True)
  )
)
Number of parameters: 84071812
/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py:171: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  weights = torch.tensor(weights, dtype=torch.float).to(device)
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.0000    0.0000    0.0000      2078
           1     0.0000    0.0000    0.0000        26
           2     0.0000    0.0000    0.0000        71
           3     0.4888    1.0000    0.6567      2080

    accuracy                         0.4888      4255
   macro avg     0.1222    0.2500    0.1642      4255
weighted avg     0.2390    0.4888    0.3210      4255

Epoch 1/5:
  Train Loss: 1.3154
  Val Loss: 1.2316, Accuracy: 0.4888, Precision: 0.1222, Recall: 0.2500, F1-score: 0.1642
  Saved new best model with F1-score: 0.1642
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.0000    0.0000    0.0000      2078
           1     0.0000    0.0000    0.0000        26
           2     0.0000    0.0000    0.0000        71
           3     0.4888    1.0000    0.6567      2080

    accuracy                         0.4888      4255
   macro avg     0.1222    0.2500    0.1642      4255
weighted avg     0.2390    0.4888    0.3210      4255

Epoch 2/5:
  Train Loss: 1.1268
  Val Loss: 1.0221, Accuracy: 0.4888, Precision: 0.1222, Recall: 0.2500, F1-score: 0.1642
Epoch 3 Training:   5%|██▌                                                | 41/798 [00:31<09:53,  1.27it/s, loss=1.0164]Traceback (most recent call last):
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 216, in <module>
    main('final.csv')
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 183, in main
    train_loss = train_epoch(model, train_loader, optimizer, criterion, device, epoch)
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py", line 115, in train_epoch
    total_loss += loss.item() * GRADIENT_ACCUMULATION_STEPS
KeyboardInterrupt

(mamba-env) pingvin@DESKTOP-84F9M51:/mnt/f/dataset$ python3 Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py
Using device: cuda
Loading data from final.csv...
Total samples: 10636
Train samples: 6381
Validation samples: 4255
Model: MambaClassifier(
  (embedding): Embedding(30522, 768)
  (mamba_layers): ModuleList(
    (0-3): 4 x Mamba(
      (in_proj): Linear(in_features=768, out_features=3072, bias=False)
      (conv1d): Conv1d(1536, 1536, kernel_size=(4,), stride=(1,), padding=(3,), groups=1536)
      (act): SiLU()
      (x_proj): Linear(in_features=1536, out_features=80, bias=False)
      (dt_proj): Linear(in_features=48, out_features=1536, bias=True)
      (out_proj): Linear(in_features=1536, out_features=768, bias=False)
    )
  )
  (global_pool): AdaptiveAvgPool1d(output_size=1)
  (classifier): Sequential(
    (0): Linear(in_features=768, out_features=384, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=384, out_features=4, bias=True)
  )
)
Number of parameters: 38821252
/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py:171: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  weights = torch.tensor(weights, dtype=torch.float).to(device)
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.9501    0.9995    0.9742      2078
           1     0.0000    0.0000    0.0000        26
           2     0.0000    0.0000    0.0000        71
           3     0.9995    0.9942    0.9969      2080

    accuracy                         0.9741      4255
   macro avg     0.4874    0.4984    0.4928      4255
weighted avg     0.9526    0.9741    0.9631      4255

Epoch 1/5:
  Train Loss: 0.6037
  Val Loss: 0.1156, Accuracy: 0.9741, Precision: 0.4874, Recall: 0.4984, F1-score: 0.4928
  Saved new best model with F1-score: 0.4928
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.9732    0.9947    0.9838      2078
           1     0.0000    0.0000    0.0000        26
           2     0.0000    0.0000    0.0000        71
           3     0.9723    0.9962    0.9841      2080

    accuracy                         0.9727      4255
   macro avg     0.4864    0.4977    0.4920      4255
weighted avg     0.9506    0.9727    0.9615      4255

Epoch 2/5:
  Train Loss: 0.0976
  Val Loss: 0.0740, Accuracy: 0.9727, Precision: 0.4864, Recall: 0.4977, F1-score: 0.4920
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.9880    0.9913    0.9897      2078
           1     0.0000    0.0000    0.0000        26
           2     0.5000    0.1549    0.2366        71
           3     0.9674    0.9990    0.9830      2080

    accuracy                         0.9751      4255
   macro avg     0.6139    0.5363    0.5523      4255
weighted avg     0.9638    0.9751    0.9678      4255

Epoch 3/5:
  Train Loss: 0.0718
  Val Loss: 0.0577, Accuracy: 0.9751, Precision: 0.6139, Recall: 0.5363, F1-score: 0.5523
  Saved new best model with F1-score: 0.5523
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.9976    0.9880    0.9927      2078
           1     0.0000    0.0000    0.0000        26
           2     0.5862    0.9577    0.7273        71
           3     0.9981    0.9986    0.9983      2080

    accuracy                         0.9866      4255
   macro avg     0.6455    0.7361    0.6796      4255
weighted avg     0.9849    0.9866    0.9850      4255

Epoch 4/5:
  Train Loss: 0.0470
  Val Loss: 0.0388, Accuracy: 0.9866, Precision: 0.6455, Recall: 0.7361, F1-score: 0.6796
  Saved new best model with F1-score: 0.6796
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.9899    0.9918    0.9909      2078
           1     0.0000    0.0000    0.0000        26
           2     0.5495    0.7042    0.6173        71
           3     0.9971    0.9981    0.9976      2080

    accuracy                         0.9840      4255
   macro avg     0.6341    0.6735    0.6514      4255
weighted avg     0.9800    0.9840    0.9819      4255

Epoch 5/5:
  Train Loss: 0.0445
  Val Loss: 0.0474, Accuracy: 0.9840, Precision: 0.6341, Recall: 0.6735, F1-score: 0.6514

Training finished!
Best Validation F1-score: 0.6796
Saving plots to results...
Plots saved successfully.
(mamba-env) pingvin@DESKTOP-84F9M51:/mnt/f/dataset$ python3 Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py
Using device: cuda
Loading data from final.csv...
Total samples: 10636
Train samples: 6381
Validation samples: 4255
Model: MambaClassifier(
  (embedding): Embedding(30522, 768)
  (mamba_layers): ModuleList(
    (0-3): 4 x Mamba(
      (in_proj): Linear(in_features=768, out_features=3072, bias=False)
      (conv1d): Conv1d(1536, 1536, kernel_size=(4,), stride=(1,), padding=(3,), groups=1536)
      (act): SiLU()
      (x_proj): Linear(in_features=1536, out_features=80, bias=False)
      (dt_proj): Linear(in_features=48, out_features=1536, bias=True)
      (out_proj): Linear(in_features=1536, out_features=768, bias=False)
    )
  )
  (global_pool): AdaptiveAvgPool1d(output_size=1)
  (classifier): Sequential(
    (0): Linear(in_features=768, out_features=384, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=384, out_features=4, bias=True)
  )
)
Number of parameters: 38821252
/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_pure_mamba.py:171: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  weights = torch.tensor(weights, dtype=torch.float).to(device)
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.9502    1.0000    0.9744      2078
           1     0.0000    0.0000    0.0000        26
           2     0.0000    0.0000    0.0000        71
           3     1.0000    0.9942    0.9971      2080

    accuracy                         0.9744      4255
   macro avg     0.4875    0.4986    0.4929      4255
weighted avg     0.9529    0.9744    0.9633      4255

Epoch 1/5:
  Train Loss: 8564.2874
  Val Loss: 0.9942, Accuracy: 0.9744, Precision: 0.9529, Recall: 0.9744, F1-score: 0.9633
  Saved new best model with F1-score: 0.9633
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.9502    1.0000    0.9744      2078
           1     0.0000    0.0000    0.0000        26
           2     0.0000    0.0000    0.0000        71
           3     1.0000    0.9942    0.9971      2080

    accuracy                         0.9744      4255
   macro avg     0.4875    0.4986    0.4929      4255
weighted avg     0.9529    0.9744    0.9633      4255

Epoch 2/5:
  Train Loss: 0.9100
  Val Loss: 0.7965, Accuracy: 0.9744, Precision: 0.9529, Recall: 0.9744, F1-score: 0.9633
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.9502    1.0000    0.9744      2078
           1     0.0000    0.0000    0.0000        26
           2     0.0000    0.0000    0.0000        71
           3     1.0000    0.9942    0.9971      2080

    accuracy                         0.9744      4255
   macro avg     0.4875    0.4986    0.4929      4255
weighted avg     0.9529    0.9744    0.9633      4255

Epoch 3/5:
  Train Loss: 0.4793
  Val Loss: 0.3113, Accuracy: 0.9744, Precision: 0.9529, Recall: 0.9744, F1-score: 0.9633
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.9502    1.0000    0.9744      2078
           1     0.0000    0.0000    0.0000        26
           2     0.0000    0.0000    0.0000        71
           3     1.0000    0.9942    0.9971      2080

    accuracy                         0.9744      4255
   macro avg     0.4875    0.4986    0.4929      4255
weighted avg     0.9529    0.9744    0.9633      4255

Epoch 4/5:
  Train Loss: 0.2924
  Val Loss: 0.2479, Accuracy: 0.9744, Precision: 0.9529, Recall: 0.9744, F1-score: 0.9633
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.9502    1.0000    0.9744      2078
           1     0.0000    0.0000    0.0000        26
           2     0.0000    0.0000    0.0000        71
           3     1.0000    0.9942    0.9971      2080

    accuracy                         0.9744      4255
   macro avg     0.4875    0.4986    0.4929      4255
weighted avg     0.9529    0.9744    0.9633      4255

Epoch 5/5:
  Train Loss: 0.2225
  Val Loss: 0.1675, Accuracy: 0.9744, Precision: 0.9529, Recall: 0.9744, F1-score: 0.9633

Training finished!
Best Validation F1-score: 0.9633
Saving plots to results...
Plots saved successfully.
(mamba-env) pingvin@DESKTOP-84F9M51:/mnt/f/dataset$ python3 Automatised-Analysis-of-Darknet-Sources/train_aemamba.py
Traceback (most recent call last):
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_aemamba.py", line 16, in <module>
    from model import SparseAE_CNN_Mamba # <--- Changed model import
ModuleNotFoundError: No module named 'model'
(mamba-env) pingvin@DESKTOP-84F9M51:/mnt/f/dataset$ python3 Automatised-Analysis-of-Darknet-Sources/train_aemamba.py
Using device: cuda
Loading data from final.csv...
Total samples: 10636
Train samples: 8508
Validation samples: 2128
Model: SparseAE_CNN_Mamba(
  (embed): Embedding(30522, 256)
  (ae): SparseLinearAE(
    (encoder): Linear(in_features=256, out_features=128, bias=True)
    (decoder): Linear(in_features=128, out_features=256, bias=True)
  )
  (conv): Conv1d(128, 128, kernel_size=(5,), stride=(1,), padding=(2,))
  (pool): AdaptiveMaxPool1d(output_size=64)
  (mamba): Mamba(
    (in_proj): Linear(in_features=128, out_features=512, bias=False)
    (conv1d): Conv1d(256, 256, kernel_size=(4,), stride=(1,), padding=(3,), groups=256)
    (act): SiLU()
    (x_proj): Linear(in_features=256, out_features=136, bias=False)
    (dt_proj): Linear(in_features=8, out_features=256, bias=True)
    (out_proj): Linear(in_features=256, out_features=128, bias=False)
  )
  (fc): Linear(in_features=128, out_features=4, bias=True)
)
Number of parameters: 8115460
Traceback (most recent call last):
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_aemamba.py", line 274, in <module>
    main("final.csv")
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_aemamba.py", line 242, in main
    evaluate(model, val_loader, criterion_classif, criterion_recon, device)
  File "/mnt/f/dataset/Automatised-Analysis-of-Darknet-Sources/train_aemamba.py", line 199, in evaluate
    print(classification_report(all_labels, all_preds, digits=4))
NameError: name 'classification_report' is not defined
^C
(mamba-env) pingvin@DESKTOP-84F9M51:/mnt/f/dataset$ python3 Automatised-Analysis-of-Darknet-Sources/train_aemamba.py
Using device: cuda
Loading data from final.csv...
Total samples: 10636
Train samples: 8508
Validation samples: 2128
Model: SparseAE_CNN_Mamba(
  (embed): Embedding(30522, 256)
  (ae): SparseLinearAE(
    (encoder): Linear(in_features=256, out_features=128, bias=True)
    (decoder): Linear(in_features=128, out_features=256, bias=True)
  )
  (conv): Conv1d(128, 128, kernel_size=(5,), stride=(1,), padding=(2,))
  (pool): AdaptiveMaxPool1d(output_size=64)
  (mamba): Mamba(
    (in_proj): Linear(in_features=128, out_features=512, bias=False)
    (conv1d): Conv1d(256, 256, kernel_size=(4,), stride=(1,), padding=(3,), groups=256)
    (act): SiLU()
    (x_proj): Linear(in_features=256, out_features=136, bias=False)
    (dt_proj): Linear(in_features=8, out_features=256, bias=True)
    (out_proj): Linear(in_features=256, out_features=128, bias=False)
  )
  (fc): Linear(in_features=128, out_features=4, bias=True)
)
Number of parameters: 8115460
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.9523    0.9990    0.9751      1039
           1     0.0000    0.0000    0.0000        13
           2     0.0000    0.0000    0.0000        36
           3     0.9990    0.9971    0.9981      1040

    accuracy                         0.9751      2128
   macro avg     0.4878    0.4990    0.4933      2128
weighted avg     0.9532    0.9751    0.9639      2128

Epoch 1/5:
  Train Loss (Total): 1.0054 (Classif: 0.2920, Recon: 0.7131, Sparsity: 0.0003)
  Val Loss (Total): 0.6702 (Classif: 0.1075, Recon: 0.5623, Sparsity: 0.0004)
  Val Accuracy: 0.9751, Precision: 0.9532, Recall: 0.9751, F1-score: 0.9639
  Saved new best model with F1-score: 0.9639
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.9523    0.9990    0.9751      1039
           1     0.0000    0.0000    0.0000        13
           2     0.0000    0.0000    0.0000        36
           3     0.9990    0.9971    0.9981      1040

    accuracy                         0.9751      2128
   macro avg     0.4878    0.4990    0.4933      2128
weighted avg     0.9532    0.9751    0.9639      2128

Epoch 2/5:
  Train Loss (Total): 0.5897 (Classif: 0.1214, Recon: 0.4679, Sparsity: 0.0004)
  Val Loss (Total): 0.5013 (Classif: 0.0905, Recon: 0.4104, Sparsity: 0.0004)
  Val Accuracy: 0.9751, Precision: 0.9532, Recall: 0.9751, F1-score: 0.9639
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.9523    1.0000    0.9756      1039
           1     0.0000    0.0000    0.0000        13
           2     0.0000    0.0000    0.0000        36
           3     1.0000    0.9971    0.9986      1040

    accuracy                         0.9756      2128
   macro avg     0.4881    0.4993    0.4935      2128
weighted avg     0.9537    0.9756    0.9643      2128

Epoch 3/5:
  Train Loss (Total): 0.4833 (Classif: 0.1244, Recon: 0.3584, Sparsity: 0.0005)
  Val Loss (Total): 0.4221 (Classif: 0.0872, Recon: 0.3345, Sparsity: 0.0005)
  Val Accuracy: 0.9756, Precision: 0.9537, Recall: 0.9756, F1-score: 0.9643
  Saved new best model with F1-score: 0.9643
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.9523    0.9990    0.9751      1039
           1     0.0000    0.0000    0.0000        13
           2     0.0000    0.0000    0.0000        36
           3     0.9990    0.9971    0.9981      1040

    accuracy                         0.9751      2128
   macro avg     0.4878    0.4990    0.4933      2128
weighted avg     0.9532    0.9751    0.9639      2128

Epoch 4/5:
  Train Loss (Total): 0.4026 (Classif: 0.0973, Recon: 0.3048, Sparsity: 0.0005)
  Val Loss (Total): 0.3672 (Classif: 0.0735, Recon: 0.2932, Sparsity: 0.0005)
  Val Accuracy: 0.9751, Precision: 0.9532, Recall: 0.9751, F1-score: 0.9639
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/mnt/f/dataset/mamba-env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
              precision    recall  f1-score   support

           0     0.9737    0.9990    0.9862      1039
           1     0.0000    0.0000    0.0000        13
           2     0.5600    0.3889    0.4590        36
           3     1.0000    0.9971    0.9986      1040

    accuracy                         0.9817      2128
   macro avg     0.6334    0.5963    0.6109      2128
weighted avg     0.9736    0.9817    0.9773      2128

Epoch 5/5:
  Train Loss (Total): 0.3499 (Classif: 0.0786, Recon: 0.2708, Sparsity: 0.0005)
  Val Loss (Total): 0.3153 (Classif: 0.0510, Recon: 0.2638, Sparsity: 0.0005)
  Val Accuracy: 0.9817, Precision: 0.9736, Recall: 0.9817, F1-score: 0.9773
  Saved new best model with F1-score: 0.9773

Training finished!
Best Validation F1-score: 0.9773
Saving plots to results_sparse_ae_cnn_mamba...
Plots saved successfully.
(mamba-env) pingvin@DESKTOP-84F9M51:/mnt/f/dataset$
